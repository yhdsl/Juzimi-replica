Drupal.settings.views=Drupal.settings.views||{ajax_path:"views/ajax"};Drupal.behaviors.quicktabs=function(a){$(".quicktabs_wrapper:not(.quicktabs-processed)",a).addClass("quicktabs-processed").each(function(){Drupal.quicktabs.prepare(this)})};Drupal.quicktabs=Drupal.quicktabs||{};Drupal.quicktabs.ajax={};Drupal.quicktabs.scripts={};Drupal.quicktabs.css={};Drupal.quicktabs.prepare=function(c){var b=0;var d=c.id.substring(c.id.indexOf("-")+1);$(c).find("ul.quicktabs_tabs li a").each(function(){this.myTabIndex=b++;this.qtid=d;$(this).unbind("click").bind("click",quicktabsClick)});var a=$(c).children(".quicktabs_tabs").find("li.active a");if(a.hasClass("qt_tab")||a.hasClass("qt_ajax_tab")){a.trigger("click")}else{$(c).children(".quicktabs_tabs").find("li.first a").trigger("click")}return false};Drupal.quicktabs.tab=function(e){this.element=e;this.tabIndex=e.myTabIndex;this.qtid=e.qtid;var a="qt_"+this.qtid;var c=0;for(var b in Drupal.settings.quicktabs[a].tabs){if(c==this.tabIndex){this.tabObj=Drupal.settings.quicktabs[a].tabs[b];this.tabKey=b}c++}this.tabpage_id="quicktabs_tabpage_"+this.qtid+"_"+this.tabKey;this.container=$("#quicktabs_container_"+this.qtid);this.tabpage=this.container.find("#"+this.tabpage_id);var d=this;this.options={success:function(f){return d.success(f)},complete:function(f){return d.complete()}}};Drupal.quicktabs.tab.prototype.success=function(a){this.container.append(Drupal.theme("quicktabsResponse",this,a.data.content));$.extend(true,Drupal.settings,a.data.js_css.js_settings);Drupal.quicktabs.ajax.scripts(a.data.js_css.js_files);Drupal.quicktabs.ajax.css_files(a.data.js_css.css_files);Drupal.attachBehaviors(this.container);var b=parseInt(COOKIE.get("homere"));if(b<30){COOKIE.set("homere",b+1)}else{COOKIE.set("homere",1)}};Drupal.quicktabs.tab.prototype.complete=function(){this.stopProgress()};Drupal.quicktabs.tab.prototype.stopProgress=function(){if(this.progress.element){$(this.progress.element).remove()}$(this.element).removeClass("progress-disabled").attr("disabled",false)};Drupal.quicktabs.tab.prototype.startProgress=function(){var a=new Drupal.progressBar("qt-progress-"+this.element.id,null,null,null);a.setProgress(-1,Drupal.t("Loading"));this.progress={};this.progress.element=$(a.element).addClass("qt-progress qt-progress-bar");this.container.prepend(this.progress.element)};Drupal.quicktabs.tab.prototype.quicktabsAjaxView=function(){var tab=this;tab.container.append(Drupal.theme("quicktabsResponse",this,null));var target;target=$("#"+tab.tabpage_id+" > div");var ajax_path=Drupal.settings.views.ajax_path;if(ajax_path.constructor.toString().indexOf("Array")!=-1){ajax_path=ajax_path[0]}var args;if(tab.tabObj.args!=""){args=tab.tabObj.args.join("/")}else{args=""}var viewData={view_name:tab.tabObj.vid,view_display_id:tab.tabObj.display,view_args:args};$.ajax({url:ajax_path,type:"GET",data:viewData,success:function(response){if(response.__callbacks){$.each(response.__callbacks,function(i,callback){eval(callback)(target,response)})}},complete:function(){tab.stopProgress()},error:function(){alert(Drupal.t("An error occurred at @path.",{"@path":ajax_path}))},dataType:"json"})};var quicktabsClick=function(){var b=new Drupal.quicktabs.tab(this);$(this).parents("li").siblings().removeClass("active");$(this).parents("li").addClass("active");b.container.children().addClass("quicktabs-hide");if(b.tabpage.hasClass("quicktabs_tabpage")){b.tabpage.removeClass("quicktabs-hide")}else{if($(this).hasClass("qt_ajax_tab")){b.startProgress();if(b.tabObj.type!="view"){var a=Drupal.settings.basePath+"quicktabs/ajax/"+b.tabObj.type+"/";switch(b.tabObj.type){case"node":a+=b.tabObj.nid+"/"+b.tabObj.teaser+"/"+b.tabObj.hide_title;break;case"block":if(b.qtid==1&&b.tabObj.bid=="views_delta_recom-block_1"){var c=parseInt(COOKIE.get("homere"));if(!c||c>30){c=0}a+=b.qtid+"/"+b.tabObj.bid+"/"+(c+1)}else{a+=b.qtid+"/"+b.tabObj.bid+"/"+b.tabObj.hide_title}break;case"qtabs":a+=b.tabObj.qtid;break}$.ajax({url:a,type:"GET",data:null,success:b.options.success,complete:b.options.complete,dataType:"json"})}else{b.quicktabsAjaxView()}}}return false};Drupal.theme.prototype.quicktabsResponse=function(b,c){var a=b.tabObj.type=="view"?'<div id="'+b.tabpage_id+'" class="quicktabs_tabpage"><div></div></div>':'<div id="'+b.tabpage_id+'" class="quicktabs_tabpage">'+c+"</div>";return a};Drupal.quicktabs.ajax.scripts=function(b){$("script").each(function(){Drupal.quicktabs.scripts[$(this).attr("src")]=$(this).attr("src")});var a="";for(i in b){if(!Drupal.quicktabs.scripts[b[i]]&&!b[i].match(/^\/misc\/jquery\.js.*$/)){Drupal.quicktabs.scripts[b[i]]=b[i];a+='<script type="text/javascript" src="'+b[i]+'"><\/script>'}}if(a){$("body").append($(a))}};Drupal.quicktabs.ajax.css_files=function(b){$("link:not(.qt-temporary-css)").each(function(){if($(this).attr("type")=="text/css"){Drupal.quicktabs.css[$(this).attr("href")]=$(this).attr("href")}});var a="";for(i in b){if(!Drupal.quicktabs.css[b[i].file]){a+='<link class="qt-temporary-css" type="text/css" rel="stylesheet" media="'+b[i].media+'" href="'+b[i].file+'" />'}}if(a){$("link.ctools-temporary-css").remove();$("body").append($(a))}};
